---
import { Image } from 'astro:assets';
import ResenaImg from '@/assets/imagenes/testimonios.webp';

const testimonios = [
  {
    texto: "La experiencia que he tenido ha sido muy accesible, cómoda, y satisfactoria. Ya que se adapta a mis necesidades, y ocupaciones, por lo cual puedo continuar trabajando. Y a la misma vez seguir estudiando. Ya que los horarios son accesibles.",
    nombre: "Pacheco Cuellar Aaron Smirnoff",
    programa: "Lic. Administración"
  },
  {
    texto: "Estudiar en línea me ha permitido balancear mi vida personal y profesional de manera efectiva. La flexibilidad y calidad educativa son excepcionales.",
    nombre: "María González Pérez",
    programa: "Lic. Contaduría"
  },
  {
    texto: "La plataforma es intuitiva y los profesores están siempre disponibles. He logrado desarrollar nuevas habilidades sin sacrificar mi trabajo.",
    nombre: "Carlos Ramírez Torres",
    programa: "Ing. Industrial"
  }
];
---

<section class="py-12 md:py-20 px-4">
  <div class="max-w-7xl mx-auto">
    <!-- Encabezado -->
    <div class="text-center mb-8 md:mb-12">
      <h2 class="text-2xl md:text-4xl font-bold mb-2 text-gray-800">
        Conoce la experiencia en línea de algunos de nuestros alumnos
      </h2>
      <p class="text-base md:text-lg font-semibold text-gray-700">
        Historias reales de personas que transformaron su futuro
      </p>
    </div>

    <!-- Contenedor principal -->
    <div class="flex flex-col lg:flex-row items-center gap-8 lg:gap-12">
      <!-- Imagen - Se mantiene estática -->
      <div class="w-full lg:w-1/2">
        <div class="relative rounded-2xl overflow-hidden shadow-lg">
          <Image 
            src={ResenaImg}
            alt="Estudiante en línea"
            class="w-full h-auto"
            loading="lazy"
          />
        </div>
      </div>

      <!-- Carrusel de testimonios -->
      <div class="w-full lg:w-1/2 relative">
        <div class="splide testimonios-carousel">
          
         
          <div class="splide__track">
            <ul class="splide__list flex">
              {testimonios.map((testimonio, index) => (
                <li class="splide__slide w-full" key={index}>
                  <div class="bg-azul-une text-white rounded-2xl p-8 md:p-10 shadow-xl relative min-h-[300px] md:min-h-[350px] flex flex-col justify-between">
                    <!-- Icono de comillas -->
                    <div class="mb-4 opacity-50 w-10">
                      <svg viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <path d="M5.29289 1.29291L6.70711 2.70712L3 6.41423V7.00001H7V14H1V5.5858L5.29289 1.29291Z" fill="#ffffff"></path> <path d="M15 7.00001H11V6.41423L14.7071 2.70712L13.2929 1.29291L9 5.5858V14H15V7.00001Z" fill="#ffffff"></path> </g></svg>
                    </div>
                    
                    <!-- Texto del testimonio -->
                    <div class="grow">
                      <p class="text-base md:text-lg leading-relaxed mb-6">
                        {testimonio.texto}
                      </p>
                    </div>
                    
                    <!-- Autor -->
                    <div class="mt-4">
                      <p class="font-bold text-lg md:text-xl">
                        {testimonio.nombre}
                      </p>
                      <p class="text-sm md:text-base opacity-90">
                        {testimonio.programa}
                      </p>
                    </div>
                  </div>
                </li>
              ))}
            </ul>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<script>
  import Splide from '@splidejs/splide';
  import '@splidejs/splide/css';

  function initSplide() {
    const splideElement = document.querySelector('.testimonios-carousel');
    
    if (splideElement instanceof HTMLElement && !splideElement.classList.contains('is-initialized')) {
      const splide = new Splide(splideElement, {
        type: 'loop',
        perPage: 1,
        perMove: 1,
        gap: '1rem',
        arrows: false,
        pagination: true,
        autoplay: true,
        interval: 5000,
        pauseOnHover: true,
        pauseOnFocus: true,
        speed: 600,
      });

      splide.mount();
      splideElement.classList.add('is-initialized');
    }
  }

  // Para Astro con transiciones
  document.addEventListener('astro:page-load', initSplide);
  
  // Para carga inicial
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', initSplide);
  } else {
    initSplide();
  }
</script>